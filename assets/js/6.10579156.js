(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{320:function(t,a,s){"use strict";s.r(a);var e=s(8),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"entitymanager-和-repository"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#entitymanager-和-repository"}},[t._v("#")]),t._v(" EntityManager 和 Repository")]),t._v(" "),a("h3",{attrs:{id:"entitymanager"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#entitymanager"}},[t._v("#")]),t._v(" EntityManager")]),t._v(" "),a("p",[t._v("可以管理（insert, update, delete, load 等）任何实体。 "),a("code",[t._v("EntityManager")]),t._v(" 就像放一个实体存储库的集合的地方。")]),t._v(" "),a("h4",{attrs:{id:"api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#api"}},[t._v("#")]),t._v(" API")]),t._v(" "),a("h5",{attrs:{id:"概览"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概览"}},[t._v("#")]),t._v(" 概览")]),t._v(" "),a("ul",[a("li",[t._v("save：新增或者修改 Entity，如果传入了 id 会先 select 再决定修改还新增")]),t._v(" "),a("li",[t._v("update：直接修改 Entity，不会先 select")]),t._v(" "),a("li",[t._v("insert：直接插入 Entity")]),t._v(" "),a("li",[t._v("delete：删除 Entity，通过 id")]),t._v(" "),a("li",[t._v("remove：删除 Entity，通过对象")]),t._v(" "),a("li",[t._v("find：查找多条记录，可以指定 where、order by 等条件")]),t._v(" "),a("li",[t._v("findBy：查找多条记录，第二个参数直接指定 where 条件，更简便一点")]),t._v(" "),a("li",[t._v("findAndCount：查找多条记录，并返回总数量")]),t._v(" "),a("li",[t._v("findByAndCount：根据条件查找多条记录，并返回总数量")]),t._v(" "),a("li",[t._v("findOne：查找单条记录，可以指定 where、order by 等条件")]),t._v(" "),a("li",[t._v("findOneBy：查找单条记录，第二个参数直接指定 where 条件，更简便一点")]),t._v(" "),a("li",[t._v("findOneOrFail：查找失败会抛 EntityNotFoundError 的异常")]),t._v(" "),a("li",[t._v("query：直接执行 sql 语句")]),t._v(" "),a("li",[t._v("createQueryBuilder：创建复杂 sql 语句，比如 join 多个 Entity 的查询")]),t._v(" "),a("li",[t._v("transaction：包裹一层事务的 sql")]),t._v(" "),a("li",[t._v("getRepository：拿到对单个 Entity 操作的类，方法同 EntityManager")])]),t._v(" "),a("h5",{attrs:{id:"findone"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#findone"}},[t._v("#")]),t._v(" findOne")]),t._v(" "),a("p",[t._v("查找单条记录，可以指定 where、order by 等条件。")]),t._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("findOne")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("User"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("select")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("age")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("where")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("order")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("age")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ASC'")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br")])]),a("h5",{attrs:{id:"findoneby"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#findoneby"}},[t._v("#")]),t._v(" findOneBy")]),t._v(" "),a("p",[t._v("查找单条记录，第二个参数直接指定 where 条件。")]),t._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("findOneBy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("User"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("age")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("h5",{attrs:{id:"save"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#save"}},[t._v("#")]),t._v(" save")]),t._v(" "),a("p",[t._v("新增或者修改 Entity,如果传入了 id 会先 select 再决定修改还新增。")]),t._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" booking1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Booking")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("entityManage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("save")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Booking"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" booking1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("h5",{attrs:{id:"findandcount"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#findandcount"}},[t._v("#")]),t._v(" findAndCount")]),t._v(" "),a("p",[t._v("查找并分页，返回 "),a("code",[t._v("[list, count]")])]),t._v(" "),a("h4",{attrs:{id:"find选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#find选项"}},[t._v("#")]),t._v(" Find选项")]),t._v(" "),a("h5",{attrs:{id:"skip"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#skip"}},[t._v("#")]),t._v(" skip")]),t._v(" "),a("p",[t._v("分页时偏移条数")]),t._v(" "),a("h5",{attrs:{id:"take"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#take"}},[t._v("#")]),t._v(" take")]),t._v(" "),a("p",[t._v("limit（分页，每页条数）")]),t._v(" "),a("h5",{attrs:{id:"relations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#relations"}},[t._v("#")]),t._v(" relations")]),t._v(" "),a("p",[t._v("关联查询实体")]),t._v(" "),a("h5",{attrs:{id:"select"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#select"}},[t._v("#")]),t._v(" select")]),t._v(" "),a("p",[t._v("需要查询哪些字段")]),t._v(" "),a("h5",{attrs:{id:"where"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#where"}},[t._v("#")]),t._v(" where")]),t._v(" "),a("p",[t._v("查询条件")]),t._v(" "),a("h3",{attrs:{id:"repository"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#repository"}},[t._v("#")]),t._v(" Repository")]),t._v(" "),a("p",[a("code",[t._v("Repository")]),t._v(" 就像 "),a("code",[t._v("EntityManager")]),t._v(" 一样，但其操作仅限于具体实体。")])])}),[],!1,null,null,null);a.default=n.exports}}]);